{"ast":null,"code":"import React,{useContext,useEffect,useState}from\"react\";import{Navigate,useLocation}from\"react-router-dom\";import{AuthContext}from\"../context/AuthContext\";import{jsx as _jsx}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{children}=_ref;const{user,checkUser}=useContext(AuthContext);const location=useLocation();const[isValid,setIsValid]=useState(user?true:null);useEffect(()=>{if(!user){const verify=async()=>{const result=await checkUser();setIsValid(result);};verify();}},[user,checkUser]);if(isValid===null)return null;// ou un spinner\nif(!isValid){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true,state:{from:location.pathname}});}return children;};export default ProtectedRoute;","map":{"version":3,"names":["React","useContext","useEffect","useState","Navigate","useLocation","AuthContext","jsx","_jsx","ProtectedRoute","_ref","children","user","checkUser","location","isValid","setIsValid","verify","result","to","replace","state","from","pathname"],"sources":["C:/React/kocrou-transport -Deploy/client/src/pages/ProtectedRoute.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\r\nimport { Navigate, useLocation } from \"react-router-dom\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\n\r\nconst ProtectedRoute = ({ children }) => {\r\n  const { user, checkUser } = useContext(AuthContext);\r\n  const location = useLocation();\r\n  const [isValid, setIsValid] = useState(user ? true : null);\r\n\r\n  useEffect(() => {\r\n    if (!user) {\r\n      const verify = async () => {\r\n        const result = await checkUser();\r\n        setIsValid(result);\r\n      };\r\n      verify();\r\n    }\r\n  }, [user, checkUser]);\r\n\r\n  if (isValid === null) return null; // ou un spinner\r\n  if (!isValid) {\r\n    return (\r\n      <Navigate\r\n        to=\"/login\"\r\n        replace\r\n        state={{ from: location.pathname }}\r\n      />\r\n    );\r\n  }\r\n\r\n  return children;\r\n};\r\n\r\nexport default ProtectedRoute;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC9D,OAASC,QAAQ,CAAEC,WAAW,KAAQ,kBAAkB,CACxD,OAASC,WAAW,KAAQ,wBAAwB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAErD,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAClC,KAAM,CAAEE,IAAI,CAAEC,SAAU,CAAC,CAAGZ,UAAU,CAACK,WAAW,CAAC,CACnD,KAAM,CAAAQ,QAAQ,CAAGT,WAAW,CAAC,CAAC,CAC9B,KAAM,CAACU,OAAO,CAAEC,UAAU,CAAC,CAAGb,QAAQ,CAACS,IAAI,CAAG,IAAI,CAAG,IAAI,CAAC,CAE1DV,SAAS,CAAC,IAAM,CACd,GAAI,CAACU,IAAI,CAAE,CACT,KAAM,CAAAK,MAAM,CAAG,KAAAA,CAAA,GAAY,CACzB,KAAM,CAAAC,MAAM,CAAG,KAAM,CAAAL,SAAS,CAAC,CAAC,CAChCG,UAAU,CAACE,MAAM,CAAC,CACpB,CAAC,CACDD,MAAM,CAAC,CAAC,CACV,CACF,CAAC,CAAE,CAACL,IAAI,CAAEC,SAAS,CAAC,CAAC,CAErB,GAAIE,OAAO,GAAK,IAAI,CAAE,MAAO,KAAI,CAAE;AACnC,GAAI,CAACA,OAAO,CAAE,CACZ,mBACEP,IAAA,CAACJ,QAAQ,EACPe,EAAE,CAAC,QAAQ,CACXC,OAAO,MACPC,KAAK,CAAE,CAAEC,IAAI,CAAER,QAAQ,CAACS,QAAS,CAAE,CACpC,CAAC,CAEN,CAEA,MAAO,CAAAZ,QAAQ,CACjB,CAAC,CAED,cAAe,CAAAF,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}