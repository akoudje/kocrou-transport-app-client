{"ast":null,"code":"// client/src/routes/ProtectedAdminRoute.js\nimport React,{useEffect,useState}from\"react\";import{Navigate}from\"react-router-dom\";import smartApi from\"../utils/smartApi\";// ✅ Utilisation du wrapper\n/* const ProtectedAdminRoute = ({ children }) => {\r\n  const [isValid, setIsValid] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"adminToken\");\r\n    if (!token) return setIsValid(false);\r\n\r\n    smartApi\r\n      .get(\"/auth/user\", {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n        withCredentials: true,\r\n      })\r\n      .then((res) => {\r\n        if (res.data?.isAdmin) {\r\n          setIsValid(true);\r\n        } else {\r\n          setIsValid(false);\r\n        }\r\n      })\r\n      .catch(() => setIsValid(false));\r\n  }, []);\r\n\r\n  if (isValid === null) return null; // ou spinner\r\n  if (!isValid) return <Navigate to=\"/admin-login\" replace />;\r\n  return children;\r\n}; */import{jsx as _jsx}from\"react/jsx-runtime\";const ProtectedAdminRoute=_ref=>{let{children}=_ref;const[isValid,setIsValid]=useState(null);const{checkAdmin}=useContext(AuthContext);useEffect(()=>{const verify=async()=>{const result=await checkAdmin();setIsValid(result);};verify();},[checkAdmin]);if(isValid===null)return null;// ou spinner\nif(!isValid)return/*#__PURE__*/_jsx(Navigate,{to:\"/admin-login\",replace:true});return children;};export default ProtectedAdminRoute;","map":{"version":3,"names":["React","useEffect","useState","Navigate","smartApi","jsx","_jsx","ProtectedAdminRoute","_ref","children","isValid","setIsValid","checkAdmin","useContext","AuthContext","verify","result","to","replace"],"sources":["C:/React/kocrou-transport -Deploy/client/src/components/ProtectedAdminRoute.js"],"sourcesContent":["// client/src/routes/ProtectedAdminRoute.js\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { Navigate } from \"react-router-dom\";\r\nimport smartApi from \"../utils/smartApi\"; // ✅ Utilisation du wrapper\r\n\r\n/* const ProtectedAdminRoute = ({ children }) => {\r\n  const [isValid, setIsValid] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"adminToken\");\r\n    if (!token) return setIsValid(false);\r\n\r\n    smartApi\r\n      .get(\"/auth/user\", {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n        withCredentials: true,\r\n      })\r\n      .then((res) => {\r\n        if (res.data?.isAdmin) {\r\n          setIsValid(true);\r\n        } else {\r\n          setIsValid(false);\r\n        }\r\n      })\r\n      .catch(() => setIsValid(false));\r\n  }, []);\r\n\r\n  if (isValid === null) return null; // ou spinner\r\n  if (!isValid) return <Navigate to=\"/admin-login\" replace />;\r\n  return children;\r\n}; */\r\n\r\n\r\nconst ProtectedAdminRoute = ({ children }) => {\r\n  const [isValid, setIsValid] = useState(null);\r\n  const { checkAdmin } = useContext(AuthContext);\r\n\r\n  useEffect(() => {\r\n    const verify = async () => {\r\n      const result = await checkAdmin();\r\n      setIsValid(result);\r\n    };\r\n    verify();\r\n  }, [checkAdmin]);\r\n\r\n  if (isValid === null) return null; // ou spinner\r\n  if (!isValid) return <Navigate to=\"/admin-login\" replace />;\r\n  return children;\r\n};\r\n\r\nexport default ProtectedAdminRoute;"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,QAAQ,KAAQ,kBAAkB,CAC3C,MAAO,CAAAC,QAAQ,KAAM,mBAAmB,CAAE;AAE1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAzBA,OAAAC,GAAA,IAAAC,IAAA,yBA4BA,KAAM,CAAAC,mBAAmB,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACE,OAAO,CAAEC,UAAU,CAAC,CAAGT,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAAEU,UAAW,CAAC,CAAGC,UAAU,CAACC,WAAW,CAAC,CAE9Cb,SAAS,CAAC,IAAM,CACd,KAAM,CAAAc,MAAM,CAAG,KAAAA,CAAA,GAAY,CACzB,KAAM,CAAAC,MAAM,CAAG,KAAM,CAAAJ,UAAU,CAAC,CAAC,CACjCD,UAAU,CAACK,MAAM,CAAC,CACpB,CAAC,CACDD,MAAM,CAAC,CAAC,CACV,CAAC,CAAE,CAACH,UAAU,CAAC,CAAC,CAEhB,GAAIF,OAAO,GAAK,IAAI,CAAE,MAAO,KAAI,CAAE;AACnC,GAAI,CAACA,OAAO,CAAE,mBAAOJ,IAAA,CAACH,QAAQ,EAACc,EAAE,CAAC,cAAc,CAACC,OAAO,MAAE,CAAC,CAC3D,MAAO,CAAAT,QAAQ,CACjB,CAAC,CAED,cAAe,CAAAF,mBAAmB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}